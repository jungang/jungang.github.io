import{ac as e,R as o,W as a,a8 as s,o as t,c as r,w as d,b as n,d as m,t as l,l as i,m as u,i as c}from"./index.efa6eab6.js";import{_ as p}from"./uni-easyinput.bdf74274.js";import{r as h}from"./uni-app.es.2c453ccb.js";import{_ as f}from"./uni-forms-item.533700d2.js";import{_ as w}from"./uni-send-sms-code.d5cd0988.js";import{_ as D}from"./uni-forms.3a5ad40c.js";import{m as g}from"./login-page.mixin.a420ea4d.js";import{_ as $}from"./plugin-vue_export-helper.21dcd24c.js";import"./uni-icons.e62a94a4.js";import"./loginSuccess.f4ff3633.js";var b=$({mixins:[g],data(){return{lock:!1,formData:{phone:"",code:"",pwd:"",pwd2:""},rules:{phone:{rules:[{required:!0,errorMessage:this.$t("common.phonePlaceholder")},{pattern:/^1\d{10}$/,errorMessage:this.$t("common.formatErr")}]},code:{rules:[{required:!0,errorMessage:this.$t("common.verifyCodePlaceholder")},{pattern:/^.{6}$/,errorMessage:this.$t("common.sixDigitCode")}]},pwd:{rules:[{required:!0,errorMessage:this.$t("common.newPasswordPlaceholder")},{pattern:/^.{6,20}$/,errorMessage:this.$t("common.passwordDigits")}]},pwd2:{rules:[{required:!0,errorMessage:this.$t("common.confirmPassword")},{pattern:/^.{6,20}$/,errorMessage:this.$t("common.passwordDigits")},{validateFunction:function(e,o,a,s){return o!=a.pwd&&s("两次输入密码不一致"),!0}}]}}}},computed:{canSubmit(){return this.isPhone&&this.isPwd&&this.isCode},isPhone(){return/^1\d{10}$/.test(this.formData.phone)},isPwd(){return/^.{6,20}$/.test(this.formData.pwd)},isCode(){return/^\d{6}$/.test(this.formData.code)}},onLoad(o){o&&o.phoneNumber&&(this.formData.phone=o.phoneNumber,this.lock=!0),e({title:this.$t("common.resetNavTitle")})},onReady(){this.formData.phone&&this.$refs.shortCode.start(),this.$refs.form.setRules(this.rules)},methods:{submit(){console.log("formData",this.formData),console.log("rules",this.rules),this.$refs.form.validate().then((e=>{o.callFunction({name:"uni-id-cf",data:{action:"resetPwdBySmsCode",params:{mobile:this.formData.phone,code:this.formData.code,password:this.formData.pwd}},success:({result:e})=>{console.log(e),a({title:e.msg||"更新成功",icon:"none"}),0===e.code&&s()}})}))}}},[["render",function(e,o,a,s,g,$){const b=h(i("uni-easyinput"),p),y=h(i("uni-forms-item"),f),P=h(i("uni-send-sms-code"),w),_=u,V=h(i("uni-forms"),D),j=c;return t(),r(j,{class:"content"},{default:d((()=>[n(V,{ref:"form",value:g.formData},{default:d((()=>[n(y,{name:"phone"},{default:d((()=>[n(b,{disabled:g.lock,focus:11!=g.formData.phone.length,type:"number",class:"easyinput",inputBorder:!1,modelValue:g.formData.phone,"onUpdate:modelValue":o[0]||(o[0]=e=>g.formData.phone=e),maxlength:"11",placeholder:e.$t("common.phonePlaceholder")},null,8,["disabled","focus","modelValue","placeholder"])])),_:1}),n(y,{name:"code"},{default:d((()=>[n(b,{focus:11==g.formData.phone.length,type:"number",class:"easyinput",inputBorder:!1,modelValue:g.formData.code,"onUpdate:modelValue":o[1]||(o[1]=e=>g.formData.code=e),maxlength:"6",placeholder:e.$t("common.verifyCodePlaceholder")},{right:d((()=>[n(P,{ref:"shortCode",phone:g.formData.phone},null,8,["phone"])])),_:1},8,["focus","modelValue","placeholder"])])),_:1}),n(y,{name:"pwd"},{default:d((()=>[n(b,{type:"password",class:"easyinput",inputBorder:!1,modelValue:g.formData.pwd,"onUpdate:modelValue":o[2]||(o[2]=e=>g.formData.pwd=e),placeholder:e.$t("common.newPasswordPlaceholder")},null,8,["modelValue","placeholder"])])),_:1}),n(y,{name:"pwd2"},{default:d((()=>[n(b,{type:"password",class:"easyinput",inputBorder:!1,modelValue:g.formData.pwd2,"onUpdate:modelValue":o[3]||(o[3]=e=>g.formData.pwd2=e),placeholder:e.$t("common.confirmNewPasswordPlaceholder")},null,8,["modelValue","placeholder"])])),_:1}),n(_,{class:"send-btn-box",disabled:!$.canSubmit,type:$.canSubmit?"primary":"default",onClick:$.submit},{default:d((()=>[m(l(e.$t("common.complete")),1)])),_:1},8,["disabled","type","onClick"])])),_:1},8,["value"])])),_:1})}],["__scopeId","data-v-fe07be9e"]]);export{b as default};
