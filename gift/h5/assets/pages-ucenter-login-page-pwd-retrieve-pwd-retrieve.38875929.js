import{a9 as e,S as o,P as a,a5 as s,o as t,c as r,w as n,b as d,j as m,t as l,f as i,_ as c,i as u}from"./index.9588ac03.js";import{_ as p}from"./uni-easyinput.9830cc65.js";import{r as h}from"./uni-app.es.3623048a.js";import{_ as f}from"./uni-forms-item.52d7bd77.js";import{_ as w}from"./uni-send-sms-code.6917a773.js";import{_ as D}from"./uni-forms.21f09ba3.js";import{m as b}from"./login-page.mixin.cd7c5eb8.js";import{_ as g}from"./plugin-vue_export-helper.21dcd24c.js";import"./uni-icons.66bbb871.js";import"./loginSuccess.1c927c71.js";var $=g({mixins:[b],data(){return{lock:!1,formData:{phone:"",code:"",pwd:"",pwd2:""},rules:{phone:{rules:[{required:!0,errorMessage:this.$t("common.phonePlaceholder")},{pattern:/^1\d{10}$/,errorMessage:this.$t("common.formatErr")}]},code:{rules:[{required:!0,errorMessage:this.$t("common.verifyCodePlaceholder")},{pattern:/^.{6}$/,errorMessage:this.$t("common.sixDigitCode")}]},pwd:{rules:[{required:!0,errorMessage:this.$t("common.newPasswordPlaceholder")},{pattern:/^.{6,20}$/,errorMessage:this.$t("common.passwordDigits")}]},pwd2:{rules:[{required:!0,errorMessage:this.$t("common.confirmPassword")},{pattern:/^.{6,20}$/,errorMessage:this.$t("common.passwordDigits")},{validateFunction:function(e,o,a,s){return o!=a.pwd&&s("两次输入密码不一致"),!0}}]}}}},computed:{canSubmit(){return this.isPhone&&this.isPwd&&this.isCode},isPhone(){return/^1\d{10}$/.test(this.formData.phone)},isPwd(){return/^.{6,20}$/.test(this.formData.pwd)},isCode(){return/^\d{6}$/.test(this.formData.code)}},onLoad(o){o&&o.phoneNumber&&(this.formData.phone=o.phoneNumber,this.lock=!0),e({title:this.$t("common.resetNavTitle")})},onReady(){this.formData.phone&&this.$refs.shortCode.start(),this.$refs.form.setRules(this.rules)},methods:{submit(){console.log("formData",this.formData),console.log("rules",this.rules),this.$refs.form.validate().then((e=>{o.callFunction({name:"uni-id-cf",data:{action:"resetPwdBySmsCode",params:{mobile:this.formData.phone,code:this.formData.code,password:this.formData.pwd}},success:({result:e})=>{console.log(e),a({title:e.msg||"更新成功",icon:"none"}),0===e.code&&s()}})}))}}},[["render",function(e,o,a,s,b,g){const $=h(i("uni-easyinput"),p),y=h(i("uni-forms-item"),f),P=h(i("uni-send-sms-code"),w),_=c,V=h(i("uni-forms"),D),j=u;return t(),r(j,{class:"content"},{default:n((()=>[d(V,{ref:"form",value:b.formData},{default:n((()=>[d(y,{name:"phone"},{default:n((()=>[d($,{disabled:b.lock,focus:11!=b.formData.phone.length,type:"number",class:"easyinput",inputBorder:!1,modelValue:b.formData.phone,"onUpdate:modelValue":o[0]||(o[0]=e=>b.formData.phone=e),maxlength:"11",placeholder:e.$t("common.phonePlaceholder")},null,8,["disabled","focus","modelValue","placeholder"])])),_:1}),d(y,{name:"code"},{default:n((()=>[d($,{focus:11==b.formData.phone.length,type:"number",class:"easyinput",inputBorder:!1,modelValue:b.formData.code,"onUpdate:modelValue":o[1]||(o[1]=e=>b.formData.code=e),maxlength:"6",placeholder:e.$t("common.verifyCodePlaceholder")},{right:n((()=>[d(P,{ref:"shortCode",phone:b.formData.phone},null,8,["phone"])])),_:1},8,["focus","modelValue","placeholder"])])),_:1}),d(y,{name:"pwd"},{default:n((()=>[d($,{type:"password",class:"easyinput",inputBorder:!1,modelValue:b.formData.pwd,"onUpdate:modelValue":o[2]||(o[2]=e=>b.formData.pwd=e),placeholder:e.$t("common.newPasswordPlaceholder")},null,8,["modelValue","placeholder"])])),_:1}),d(y,{name:"pwd2"},{default:n((()=>[d($,{type:"password",class:"easyinput",inputBorder:!1,modelValue:b.formData.pwd2,"onUpdate:modelValue":o[3]||(o[3]=e=>b.formData.pwd2=e),placeholder:e.$t("common.confirmNewPasswordPlaceholder")},null,8,["modelValue","placeholder"])])),_:1}),d(_,{class:"send-btn-box",disabled:!g.canSubmit,type:g.canSubmit?"primary":"default",onClick:g.submit},{default:n((()=>[m(l(e.$t("common.complete")),1)])),_:1},8,["disabled","type","onClick"])])),_:1},8,["value"])])),_:1})}],["__scopeId","data-v-feba2adc"]]);export{$ as default};
